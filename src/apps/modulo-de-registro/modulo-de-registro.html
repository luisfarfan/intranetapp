<h5 class="page-title">Modulo de <span class="fw-semi-bold">Registro</span></h5>

<div class="row">
	<div class="col-lg-12">
		<section class="widget" widget>
			<header>
				<h6>Filtros Ubigeo</h6>
			</header>
			<div class="widget-body">
				<div class="row">
					<div class="col-lg-4">
						<div class="form-group">
							<label for="departamento">Departamento</label>
							<select class="form-control" [(ngModel)]="selectedDepartamento" (ngModelChange)="getProvincias()" name="departamento" id="departamento">
                            <option selected value="0">Seleccione</option>
                            <option *ngFor="let dep of departamentos" [value]="dep.ccdd">{{ dep.departamento }}</option>
                        </select>
						</div>
					</div>
					<div class="col-lg-4">
						<div class="form-group">
							<label for="provincia">Provincia</label>
							<select class="form-control" [(ngModel)]="selectedProvincia" (ngModelChange)="getDistritos()" name="provincia" id="provincia">
                            <option selected value="0">Seleccione</option>
                            <option *ngFor="let prov of provincias" [value]="prov.ccpp">{{ prov.provincia }}</option>
                        </select>
						</div>
					</div>
					<div class="col-lg-4">
						<div class="form-group">
							<label for="distrito">Distrito</label>
							<select class="form-control" [(ngModel)]="selectedDistrito" name="distritos" id="distrito">
                            <option selected value="0">Seleccione</option>
                            <option *ngFor="let dis of distritos" [value]="dis.ccdi">{{ dis.distrito }}</option>
                        </select>
						</div>
					</div>
				</div>
				<button md-raised-button (click)="accionAddLocal()" color="accent">Registrar Local</button>
				<button md-raised-button (click)="findLocales()" color="warn">Buscar Local</button>

			</div>
		</section>
	</div>
</div>
<div *ngIf="accion_editlocal || accion_addlocal">
	<div class="row">
		<div class="col-lg-12">
			<section class="widget" widget>
				<header>
					REGISTRAR LOCAL
				</header>
				<div class="widget-body">
					<form (ngSubmit)="onSubmit()">
						<div [formGroup]="localForm" class="row">
							<div class="col-lg-4">
								<div class="form-group">
									<label for="distrito">Local</label>
									<input formControlName="nombre_local" type="text" class="form-control">
								</div>
								<div *ngIf="formErrors.nombre_local" class="alert alert-danger">
									{{ formErrors.nombre_local }}
								</div>
								<div class="form-group">
									<label for="distrito">Dirección</label>
									<input type="text" formControlName="direccion" class="form-control">
								</div>
								<div *ngIf="formErrors.direccion" class="alert alert-danger">
									{{ formErrors.direccion }}
								</div>
								<div class="form-group">
									<label for="distrito">Referencia</label>
									<input type="text" formControlName="referencia" class="form-control">
								</div>
								<div *ngIf="formErrors.referencia" class="alert alert-danger">
									{{ formErrors.referencia }}
								</div>
								<div class="form-group">
									<label for="distrito">Teléfono</label>
									<input type="text" formControlName="telefono_local" class="form-control">
								</div>
								<div *ngIf="formErrors.telefono_local" class="alert alert-danger">
									{{ formErrors.telefono_local }}
								</div>
							</div>
							<div class="col-lg-2">
								<div class="form-group">
									<label for="distrito">Fecha Inicio</label>
									<input type="text" [textMask]="{mask: mask_date}" placeholder="DD/MM/YYYY" #fecha_inicio_input formControlName="fecha_inicio"
										class="form-control">
								</div>
								<div *ngIf="formErrors.fecha_inicio" class="alert alert-danger">
									{{ formErrors.fecha_inicio }}
								</div>
								<div class="form-group">
									<label for="distrito">#Aulas</label>
									<input type="text" formControlName="total_aulas_max" class="form-control">
								</div>
								<div *ngIf="formErrors.total_aulas_max" class="alert alert-danger">
									{{ formErrors.total_aulas_max }}
								</div>
							</div>
							<div class="col-lg-2">
								<div class="form-group">
									<label for="distrito">Fecha Fin</label>
									<input type="text" [textMask]="{mask: mask_date}" formControlName="fecha_fin" placeholder="DD/MM/YYYY" class="form-control">
								</div>
								<div *ngIf="formErrors.fecha_fin" class="alert alert-danger">
									{{ formErrors.fecha_fin }}
								</div>
								<div class="form-group">
									<label for="distrito">TotalPEA</label>
									<input type="text" formControlName="total_pea" class="form-control">
								</div>
								<div *ngIf="formErrors.total_pea" class="alert alert-danger">
									{{ formErrors.total_pea }}
								</div>
							</div>
							<div class="col-lg-4">
								<tabset [justified]="true">
									<tab heading="Funcionario">
										<div class="form-group">
											<label for="distrito">Nombre</label>
											<input formControlName="funcionario_nombre" placeholder="Nombre" type="text" class="form-control">
										</div>
										<div *ngIf="formErrors.funcionario_nombre" class="alert alert-danger">
											{{ formErrors.funcionario_nombre }}
										</div>
										<div class="form-group">
											<label for="distrito">Funcionario Email</label>
											<input formControlName="funcionario_email" placeholder="Funcionario Email" type="text" class="form-control">
										</div>
										<div *ngIf="formErrors.funcionario_email" class="alert alert-danger">
											{{ formErrors.funcionario_email }}
										</div>
										<div class="form-group">
											<label for="distrito">Celular</label>
											<input formControlName="funcionario_celular" placeholder="Funcionario Celular" type="text" class="form-control">
										</div>
										<div *ngIf="formErrors.funcionario_celular" class="alert alert-danger">
											{{ formErrors.funcionario_celular }}
										</div>
									</tab>
									<tab heading="Contacto">
										<div class="form-group">
											<label for="distrito">Contacto Nombre</label>
											<input formControlName="contacto_nombre" placeholder="Contacto Nombre" type="text" class="form-control">
										</div>
										<div *ngIf="formErrors.contacto_nombre" class="alert alert-danger">
											{{ formErrors.contacto_nombre }}
										</div>
										<div class="form-group">
											<label for="distrito">Email</label>
											<input formControlName="contacto_email" placeholder="Contacto Email" type="text" class="form-control">
										</div>
										<div *ngIf="formErrors.contacto_email" class="alert alert-danger">
											{{ formErrors.contacto_email }}
										</div>
										<div class="form-group">
											<label for="distrito">Celular</label>
											<input formControlName="contacto_celular" placeholder="Contacto Celular" type="text" class="form-control">
										</div>
										<div *ngIf="formErrors.contacto_celular" class="alert alert-danger">
											{{ formErrors.contacto_celular }}
										</div>
									</tab>
								</tabset>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-12">
								<section class="widget" widget>
									<header>INFRAESTRUCTURA DE LOCAL</header>
									<div class="widget-body">
										<div class="row">
											<div *ngFor="let infra of infraestructuras; let i=index" class="col-lg-3">
												<div class="form-group">
													<label>{{ infra.desc_infraestructura }} <span class="text-danger">(*)</span></label>
													<select [(ngModel)]="infra.estado1" name="{{'estado'+i}}" (ngModelChange)="setEstadoInfra($event,i)" class="form-control">
										<option value="0">Seleccione</option>
										<option *ngFor="let est of infra.estado" [value]="est">{{ est }}</option></select>
												</div>
											</div>
										</div>
									</div>
								</section>
							</div>
						</div>
						<button [disabled]="(!localForm.valid || !selectsInfraestructuras) || submitted" md-raised-button color="accent">Guardar</button>
						<button type="button" data-toggle="modal" data-target="#myModal" [disabled]="!selectedLocal" md-raised-button color="accent">Registrar Aulas</button>
					</form>
				</div>
			</section>
		</div>
	</div>

</div>
<div *ngIf="alert_nofindlocales" class="alert alert-danger">
	<strong>No existen locales para este ubigeo.</strong>
</div>
<ng2-toasty></ng2-toasty>
<md-card *ngIf="searchedlocales">
	<div class="table-responsive">
		<div class="ui-widget-header ui-helper-clearfix" style="padding:4px 10px;border-bottom: 0 none">
			<i class="fa fa-search" style="float:left;margin:4px 4px 0 0"></i>
			<input #gb type="text" pInputText size="50" style="float:left" placeholder="Buscador">
		</div>
		<p-dataTable class="table table-hover table-mc-light-blue" [globalFilter]="gb" (onRowSelect)="onRowSelect($event)" (onRowUnselect)="onRowUnselect($event)"
			[value]="search_locales" selectionMode="single" [(selection)]="selectedLocal">
			<p-column field="nombre_local" header="Nombre Local"></p-column>
			<p-column field="referencia" header="Referencia"></p-column>
			<p-column field="telefono_local" header="Telefono Local"></p-column>
			<p-column field="total_aulas_max" header="Total Aulas Máximas"></p-column>
			<p-column field="total_pea" header="Total PEA"></p-column>
			<p-column field="direccion" header="Dirección"></p-column>
			<p-column field="telefono_local" header="Telefono Local"></p-column>
		</p-dataTable>
	</div>
</md-card>
<!-- /.Live preview-->
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
		<!--Content-->
		<div class="modal-content">
			<!--Header-->
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
				<h4 class="modal-title" id="myModalLabel">Registro de Aulas</h4>
			</div>
			<!--Body-->
			<div class="modal-body">
				<div class="row">
					<div class="col-md-3">
						<div class="form-group">
							<label>Nro Aula</label>
							<input [(ngModel)]="aula.num_aula" name="num_aula" type="text" class="form-control" id="">
						</div>
						<div class="form-group">
							<label for="email">Capacidad</label>
							<input [(ngModel)]="aula.capacidad" name="capacidad" type="text" class="form-control" id="">
						</div>
						<div class="form-group">
							<label for="email">Mobiliario</label>
							<input [(ngModel)]="aula.mobiliario" name="mobiliario" type="text" class="form-control" id="">
						</div>
					</div>
					<div class="col-md-3">
						<div class="form-group">
							<md-checkbox [(ngModel)]="aula.internet" name="internet">
								Internet
							</md-checkbox>
						</div>

						<div class="form-group">
							<md-checkbox [(ngModel)]="aula.pizarra" name="pizarra">
								Pizarra
							</md-checkbox>
						</div>

						<div class="form-group">
							<md-checkbox [(ngModel)]="aula.unipersonales" name="unipersonales">
								Unipersonales
							</md-checkbox>
						</div>
					</div>
					<div class="col-md-3">
						<div class="form-group">
							<md-checkbox [(ngModel)]="aula.audio" name="audio">
								Audio
							</md-checkbox>
						</div>
						<div class="form-group">
							<md-checkbox [(ngModel)]="aula.proyector" name="proyector">
								Proyector
							</md-checkbox>
						</div>

					</div>
					<div class="col-md-3">
						<div class="form-group">
							<label for="">Mesas</label>
							<input [(ngModel)]="aula.mesas" class="form-control" name="mesas" type="number">
						</div>

						<div class="form-group">
							<label for="">C.Bipersonales</label>
							<input [(ngModel)]="aula.bipersonales" class="form-control" name="bipersonales" type="number">
						</div>
						<div class="form-group">
							<label for="">Sillas</label>
							<input [(ngModel)]="aula.sillas" class="form-control" name="sillas" type="number">
						</div>
					</div>
				</div>
				<button md-raised-button (click)="addAula()" color="accent">Añadir</button>
				<button [hidden]="!deleteaula" md-raised-button (click)="deleteAula()" color="accent">Eliminar</button>
				<div *ngIf="max_aulas" class="alert alert-danger">
					<strong>Ya no puede agregar mas aulas.</strong>
				</div>
				<div class="row">
					<p-dataTable class="table table-hover table-mc-light-blue" [value]="aulasbylocal" (onRowSelect)="onRowSelect2($event)" (onRowUnselect)="onRowUnSelect2($event)"
						selectionMode="single" [(selection)]="selectedAula">
						<p-column field="num_aula" header="N° Aula"></p-column>
						<p-column field="capacidad" header="Capacidad"></p-column>
						<p-column field="capacidad" header="Mobiliario c/p"></p-column>
						<p-column field="internet" header="internet"></p-column>
						<p-column field="audio" header="audio"></p-column>
						<p-column field="proyector" header="Proyector"></p-column>
						<p-column field="pizarra" header="Pizarra"></p-column>
						<p-column field="mesas" header="Mesas"></p-column>
						<p-column field="bipersonales" header="Bipersonales"></p-column>
						<p-column field="sillas" header="Sillas"></p-column>
					</p-dataTable>
				</div>
			</div>
			<!--Footer-->
		</div>

		<!--/.Content-->
	</div>
</div>
<!-- /.Live preview-->